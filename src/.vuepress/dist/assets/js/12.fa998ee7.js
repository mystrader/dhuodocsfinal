(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{390:function(e,a,t){"use strict";t.r(a);var o=t(28),r=Object(o.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"instalacao-on-premise"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#instalacao-on-premise"}},[e._v("#")]),e._v(" Instalação On Premise")]),e._v(" "),t("h1",{attrs:{id:"dhuo-api-v0-1-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dhuo-api-v0-1-0"}},[e._v("#")]),e._v(" DHUO API v0.1.0")]),e._v(" "),t("h2",{attrs:{id:"introducao"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#introducao"}},[e._v("#")]),e._v(" Introdução")]),e._v(" "),t("p",[e._v("Este manual contém instruções e requisitos para a instalação do DHUO API. A visão macro dos componentes do DHUO API pode ser vista abaixo:")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://storage.googleapis.com/strapi_prd/dhuo_api_macro_142f5c8cf1/dhuo_api_macro_142f5c8cf1.png",alt:"Dhuo API Visão Macro"}})]),e._v(" "),t("h2",{attrs:{id:"modulos-e-versoes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#modulos-e-versoes"}},[e._v("#")]),e._v(" Módulos e versões")]),e._v(" "),t("p",[e._v("Os componentes dhuo e suas versões são listados abaixo:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("módulo")]),e._v(" "),t("th",[e._v("versão")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("apimanagement-accountservice")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-devportal-web")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-healthcheck")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-product")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-schedules")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-service")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-workflow")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("apione-kong")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("dhuo-strapi")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("gdhuo")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("viaapi-service")]),e._v(" "),t("td",[e._v("v0.1.0")])]),e._v(" "),t("tr",[t("td",[e._v("viaapi-web")]),e._v(" "),t("td",[e._v("v0.1.0")])])])]),e._v(" "),t("h2",{attrs:{id:"repositorios-e-acessos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#repositorios-e-acessos"}},[e._v("#")]),e._v(" Repositórios e acessos")]),e._v(" "),t("p",[e._v("As credenciais de acesso ao docker registry e aos arquivos de template devem ser solicitados à equipe dhuo.")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th"),e._v(" "),t("th",[e._v("url")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("docker registry")]),e._v(" "),t("td",[e._v("https://registry-dhuo.br.engineering")])]),e._v(" "),t("tr",[t("td",[e._v("templates de configuração")]),e._v(" "),t("td",[e._v("https://gitlab.engdb.com.br/apione/dhuoapi-install")])])])]),e._v(" "),t("h2",{attrs:{id:"pre-requisitos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisitos"}},[e._v("#")]),e._v(" Pré-requisitos")]),e._v(" "),t("h3",{attrs:{id:"infraestrutura"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#infraestrutura"}},[e._v("#")]),e._v(" Infraestrutura")]),e._v(" "),t("p",[e._v("Os requisitos recomendados para os nós do cluster kubernetes são:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("requisito")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("10vCPU")])]),e._v(" "),t("tr",[t("td",[e._v("16GB de RAM")])]),e._v(" "),t("tr",[t("td",[e._v("150GB de disco")])])])]),e._v(" "),t("p",[e._v("As versões homologadas dos componentes de infraestrutura necessários para a instalação do dhuo são:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th"),e._v(" "),t("th",[e._v("versão")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("grafana")]),e._v(" "),t("td",[e._v("7.5.0")])]),e._v(" "),t("tr",[t("td",[e._v("kafka")]),e._v(" "),t("td",[e._v("2.7.0")])]),e._v(" "),t("tr",[t("td",[e._v("kubernetes")]),e._v(" "),t("td",[e._v("v1.20.x")])]),e._v(" "),t("tr",[t("td",[e._v("mongodb")]),e._v(" "),t("td",[e._v("4.6.0")])])])]),e._v(" "),t("h3",{attrs:{id:"ferramentas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ferramentas"}},[e._v("#")]),e._v(" Ferramentas")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th"),e._v(" "),t("th",[e._v("descrição")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("deck")]),e._v(" "),t("td",[e._v("usada na configuração dos serviços de back-end do dhuo, é utilizada a ferramenta "),t("strong",[e._v("decK")]),e._v(". Ela pode ser obtida em https://github.com/Kong/deck.")])]),e._v(" "),t("tr",[t("td",[e._v("gsutil")]),e._v(" "),t("td",[e._v("usada para configuração dos buckets no google cloud storage.")])])])]),e._v(" "),t("h3",{attrs:{id:"enderecos-de-dominio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#enderecos-de-dominio"}},[e._v("#")]),e._v(" Endereços de domínio")]),e._v(" "),t("p",[e._v("É necessário possuir o cadastro de domínio para expor o acesso aos seguintes componentes:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("módulo")]),e._v(" "),t("th",[e._v("descrição")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("apimanagement-devportal-web")]),e._v(" "),t("td",[e._v("developer portal")])]),e._v(" "),t("tr",[t("td",[e._v("apione-kong")]),e._v(" "),t("td",[e._v("camada de exposição dos serviços back-end consumidos pelos portais")])]),e._v(" "),t("tr",[t("td",[e._v("dhuo-strapi")]),e._v(" "),t("td",[e._v("cms para customização do developer portal")])]),e._v(" "),t("tr",[t("td",[e._v("viaapi-web")]),e._v(" "),t("td",[e._v("api manager, admin portal")])])])]),e._v(" "),t("h3",{attrs:{id:"google-storage-buckets"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#google-storage-buckets"}},[e._v("#")]),e._v(" Google storage buckets")]),e._v(" "),t("p",[e._v("É necessário possuir dois storage buckets para as seguintes finalidades:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("bucket")]),e._v(" "),t("th",[e._v("função")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("dhuo-cms")]),e._v(" "),t("td",[e._v("armazenamento de imagens utilizadas pelo cms e exibidas no developer portal")])]),e._v(" "),t("tr",[t("td",[e._v("dhuo-b2c")]),e._v(" "),t("td",[e._v("armazenamento dos assets utilizados na customização do front-end de SSO do Azure AD B2C")])])])]),e._v(" "),t("p",[e._v("Ambos os buckets devem possuir acesso público. Para isso, adicionar uma permission com as seguintes características:")]),e._v(" "),t("ul",[t("li",[t("strong",[e._v("Principal:")]),e._v(" allUsers")]),e._v(" "),t("li",[t("strong",[e._v("Role:")]),e._v(" Storage Object Viewer")])]),e._v(" "),t("p",[e._v("Deve ser habilitado o CORS no bucket dhuo-b2c. Para isso utilize a ferramenta "),t("code",[e._v("gsutil")]),e._v("para carregar as configurações de cors presentes no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/gs-buckets",target:"_blank",rel:"noopener noreferrer"}},[e._v("/gs-buckets"),t("OutboundLink")],1),e._v(" do repositório de templates de configuração.")]),e._v(" "),t("p",[e._v("Exemplo:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("gsutil cors set cors-config.json gs://dhuo-b2c\n")])])]),t("h3",{attrs:{id:"google-recaptcha"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#google-recaptcha"}},[e._v("#")]),e._v(" Google reCAPTCHA")]),e._v(" "),t("p",[e._v("Para logins no developer portal é utilizado o recaptcha. É necessário gerar um par de chaves de configuração do recaptcha do google.")]),e._v(" "),t("ol",[t("li",[e._v("Acessar a url https://www.google.com/recaptcha/admin")]),e._v(" "),t("li",[e._v("Registrar um novo site correspondente ao dhuo com as seguintes configurações:\n"),t("strong",[e._v("Tipo de reCAPTCHA")]),e._v(': reCAPTCHA v2; Caixa de seleção "Não sou um robô"\n'),t("strong",[e._v("Domínios:")]),e._v(" inserir dois domínios: b2clogin.com; domínio do developer portal")]),e._v(" "),t("li",[e._v("Obter site key e secret key que serão utilizados nas configurações do "),t("strong",[e._v("AD B2C")]),e._v(" e do módulo dhuo "),t("strong",[e._v("apimanagement-accountservice")]),e._v(".")])]),e._v(" "),t("h2",{attrs:{id:"azure-ad-b2c"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#azure-ad-b2c"}},[e._v("#")]),e._v(" Azure AD B2C")]),e._v(" "),t("p",[e._v("Devido ao fato da configuração do AD B2C ser realizada majoritariamente somente no setup inicial do ambiente, as instruções de provisionamento encontram-se em um manual anexo a esse. Um guia visual complementar também está disponível no repositório de templates no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/_visual-guides",target:"_blank",rel:"noopener noreferrer"}},[e._v("/_visual-guides"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("p",[t("strong",[e._v("Atenção:")]),e._v(" algumas propriedades geradas durante a instalação do AD B2C são utilizadas em configurações dos outros módulos dhuo e referenciadas neste manual.")]),e._v(" "),t("h2",{attrs:{id:"instalacao-dhuo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#instalacao-dhuo"}},[e._v("#")]),e._v(" Instalação dhuo")]),e._v(" "),t("h3",{attrs:{id:"back-ends"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#back-ends"}},[e._v("#")]),e._v(" Back-ends")]),e._v(" "),t("p",[e._v("Passos referentes aos módulos:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("módulo dhuo")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("apimanagement-accountservice")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-healthcheck")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-product")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-schedules")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-service")])]),e._v(" "),t("tr",[t("td",[e._v("apimanagement-workflow")])]),e._v(" "),t("tr",[t("td",[e._v("viaapi-service")])])])]),e._v(" "),t("p",[e._v("Para cada módulo:")]),e._v(" "),t("ol",[t("li",[e._v("Criar um arquivo "),t("strong",[e._v("application.properties")]),e._v(" a partir do modelo presente no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/config",target:"_blank",rel:"noopener noreferrer"}},[e._v("/config"),t("OutboundLink")],1),e._v(" do repositório de templates de configuração do módulo em questão.")]),e._v(" "),t("li",[e._v("Configurar as propriedades customizadas (se presentes no arquivo do módulo em questão) conforme relação abaixo:")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("propriedade")]),e._v(" "),t("th",[e._v("descrição")]),e._v(" "),t("th",[e._v("exemplo")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("app.msgraph.base-identifier-uris")]),e._v(" "),t("td",[e._v("domínio do tenant b2c em formato https://{dominio}. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.PrimaryDomain")]),t("strong",[e._v("[1]")])]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("app.msgraph.client-id")]),e._v(" "),t("td",[e._v("client ID do app msgraph configurado no tenant do AD B2C. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.app.MsGraph.clientId")]),t("strong",[e._v("[1]")])]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("app.msgraph.internal-issuer")]),e._v(" "),t("td",[e._v("domínio do tenant b2c em formato https://{dominio}. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.PrimaryDomain")]),t("strong",[e._v("[1]")])]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("app.msgraph.secret")]),e._v(" "),t("td",[e._v("client secret  do app msgraph configurado no tenant do AD B2C. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.app.MsGraph.secret")]),t("strong",[e._v("[1]")])]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("app.msgraph.service-principal-id")]),e._v(" "),t("td",[e._v("Object ID da enterprise application associada ao app apione. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.app.Apione.EnterpriseApplication.objectId")]),t("strong",[e._v("[1]")])]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("app.msgraph.tenant")]),e._v(" "),t("td",[e._v("Tenant ID do tenant b2c. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.TenantId")]),t("strong",[e._v("[1]")])]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("app.recaptcha.secret")]),e._v(" "),t("td",[e._v("secret key obtida na configuração do Google reCAPTCHA "),t("strong",[e._v("[1]")])]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("logging.file")]),e._v(" "),t("td",[e._v("path para o arquivo de armazenamento de logs")]),e._v(" "),t("td",[e._v("INFO")])]),e._v(" "),t("tr",[t("td",[e._v("logging.level.org.apache.kafka")]),e._v(" "),t("td",[e._v("nível de logs para libs kafka")]),e._v(" "),t("td",[e._v("WARN")])]),e._v(" "),t("tr",[t("td",[e._v("logging.level.org.hibernate")]),e._v(" "),t("td",[e._v("nível de logs do hibernate")]),e._v(" "),t("td",[e._v("OFF")])]),e._v(" "),t("tr",[t("td",[e._v("logging.level.org.springframework")]),e._v(" "),t("td",[e._v("nível de logs gerados pelo spring")]),e._v(" "),t("td",[e._v("ERROR")])]),e._v(" "),t("tr",[t("td",[e._v("logging.level.root")]),e._v(" "),t("td",[e._v("nível de logs gerais da aplicação")]),e._v(" "),t("td",[e._v("ERROR")])]),e._v(" "),t("tr",[t("td",[e._v("product.apiManagerUrl")]),e._v(" "),t("td",[e._v("url da aplicação apimanagement-service para comunicação interna entre módulos "),t("strong",[e._v("[2]")])]),e._v(" "),t("td",[e._v("http://apimanagement-service.dhuo:8080")])]),e._v(" "),t("tr",[t("td",[e._v("product.devPortalUrl")]),e._v(" "),t("td",[e._v("url da aplicação viaapi-service para comunicação interna entre módulos "),t("strong",[e._v("[2]")])]),e._v(" "),t("td",[e._v("http://viaapi-service.dhuo:8080")])]),e._v(" "),t("tr",[t("td",[e._v("spring.cloud.stream.kafka.binder.brokers")]),e._v(" "),t("td",[e._v("url para conexão ao broker kafka")]),e._v(" "),t("td",[e._v("dhuo-kafka:9092")])]),e._v(" "),t("tr",[t("td",[e._v("spring.data.mongodb.uri")]),e._v(" "),t("td",[e._v("string de conexão ao mongodb "),t("strong",[e._v("[3]")])]),e._v(" "),t("td",[e._v("mongodb://root:123@dhuo-mongo:27017/dhuo")])])])]),e._v(" "),t("p",[e._v("[1] configuração presente apenas no módulo "),t("strong",[e._v("apimanagement-accountservice")]),e._v(".\n[2] configuração presente apenas no módulo "),t("strong",[e._v("apimanagement-product")]),e._v(".\n[3] recomenda-se utilizar o mesmo banco (database) compartilhado entre os módulos do dhuo. Em futuros releases do produto os módulos deverão ser unificados.")]),e._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[e._v("Criar secret do tipo Opaque com nome do módulo a partir do arquivo application.properties. Exemplo:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl create secret generic <módulo dhuo> --from-file=application.properties -n <namespace>\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[t("p",[e._v("Configurar um arquivo "),t("strong",[e._v(".env")]),e._v(" a partir do modelo presente no repositório de templates em "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/config/java_opts",target:"_blank",rel:"noopener noreferrer"}},[e._v("/config/java_opts"),t("OutboundLink")],1),e._v(". Ele contém a variável de ambiente JAVA_OPTS e as configurações de inicialização de jvm. "),t("strong",[e._v("Observação:")]),e._v(" a config -Dspring.config.location é "),t("strong",[e._v("obrigatória")]),e._v(" na configuração de JAVA_OPTS e deve corresponder ao caminho configurado no deployment onde será montado o volume contendo o application.properties criado no configmap do passo anterior.")])]),e._v(" "),t("li",[t("p",[e._v("Criar configmap a partir do arquivo .env. "),t("strong",[e._v("Observação:")]),e._v(" diferente da secret, esse configmap será usado pelo deployment do módulo como conjunto de variáveis de ambiente ao invés de ser mapeada como arquivo. Exemplo:")])])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl create configmap "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("módulo dhuo"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("-vars -n "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("namespace"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" --from-env-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(".env\n")])])]),t("ol",{attrs:{start:"6"}},[t("li",[t("p",[e._v("Configurar arquivos template de objetos kubernetes (deployment.yaml, service.yaml, hpa.yaml) a partir dos modelos presentes no repositório de templates de configuração do módulo em questão no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/k8s",target:"_blank",rel:"noopener noreferrer"}},[e._v("/k8s"),t("OutboundLink")],1),e._v(". "),t("strong",[e._v("Observação:")]),e._v(" tais arquivos são modelos de referência e podem ser customizados com outras propriedades além das existentes conforme necessidade.")])]),e._v(" "),t("li",[t("p",[e._v("Realizar deploy dos objetos kubernetes no cluster a partir dos arquivos de configuração do passo anterior. Exemplo:")])])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply -f "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("diretório"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("p",[e._v("Passos referentes aos módulos")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("módulo dhuo")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("gdhuo")])])])]),e._v(" "),t("ol",[t("li",[e._v("Criar e configurar um arquivo "),t("strong",[e._v(".env")]),e._v(" a partir do modelo presente no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/config",target:"_blank",rel:"noopener noreferrer"}},[e._v("/config"),t("OutboundLink")],1),e._v(" do repositório de templates de configuração do módulo em questão. As variáveis configuráveis estão relacionadas abaixo:")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("variável")]),e._v(" "),t("th",[e._v("descrição")]),e._v(" "),t("th",[e._v("exemplo")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("MONGODB_DATABASE")]),e._v(" "),t("td",[e._v("database do dhuo no mongodb")]),e._v(" "),t("td",[e._v("dhuo")])]),e._v(" "),t("tr",[t("td",[e._v("MONGODB_OPTIONS")]),e._v(" "),t("td",[e._v("Opções extras de configuração da conexão ao mongodb.")]),e._v(" "),t("td",[e._v("authSource=admin&gssapiServiceName=mongodb")])]),e._v(" "),t("tr",[t("td",[e._v("MONGODB_PASSWORD")]),e._v(" "),t("td",[e._v("senha do usuário de acesso ao mongodb")]),e._v(" "),t("td",[e._v("123")])]),e._v(" "),t("tr",[t("td",[e._v("MONGODB_URI")]),e._v(" "),t("td",[e._v("hosts de conexão ao mongodb no formato host:port. Caso haja mais de um, separar por vírgulas.")]),e._v(" "),t("td",[e._v("dhuo-mongo-1:27017,dhuo-mongo-mongodb-2:27017")])]),e._v(" "),t("tr",[t("td",[e._v("MONGODB_USERNAME")]),e._v(" "),t("td",[e._v("usuário de conexão ao mongodb")]),e._v(" "),t("td",[e._v("root")])])])]),e._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[e._v("Criar secret do tipo Opaque com nome do módulo a partir do arquivo .env. "),t("strong",[e._v("Observação:")]),e._v(" diferente dos módulos anteriores, essa secret será usada pelo deployment do módulo como conjunto de variáveis de ambiente ao invés de ser mapeada como arquivo. Exemplo:")])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl create secret generic gdhuo --from-env-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(".env -n "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("namespace"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[e._v("Configurar arquivos template de objetos kubernetes (deployment.yaml, service.yaml, hpa.yaml) a partir dos modelos presentes no repositório de templates de configuração do módulo em questão no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/k8s",target:"_blank",rel:"noopener noreferrer"}},[e._v("/k8s"),t("OutboundLink")],1),e._v(". "),t("strong",[e._v("Observação:")]),e._v(" tais arquivos são modelos de referência e podem ser customizados com outras propriedades além das existentes conforme necessidade.")])]),e._v(" "),t("li",[t("p",[e._v("Realizar deploy dos objetos kubernetes no cluster a partir dos arquivos de configuração do passo anterior. Exemplo:")])])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply -f "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("diretório"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("h3",{attrs:{id:"front-ends"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#front-ends"}},[e._v("#")]),e._v(" Front-ends")]),e._v(" "),t("p",[e._v("Passos referentes aos módulos")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("módulo dhuo")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("apimanagement-devportal-web")])]),e._v(" "),t("tr",[t("td",[e._v("viaapi-web")])])])]),e._v(" "),t("ol",[t("li",[e._v("Criar e configurar um arquivo "),t("strong",[e._v(".env")]),e._v(" a partir do modelo presente no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/config",target:"_blank",rel:"noopener noreferrer"}},[e._v("/config"),t("OutboundLink")],1),e._v(" do repositório de templates de configuração do módulo em questão. As variáveis configuráveis estão relacionadas abaixo:")])]),e._v(" "),t("p",[t("strong",[e._v("apimanagement-devportal-web")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("variável")]),e._v(" "),t("th",[e._v("descrição")]),e._v(" "),t("th",[e._v("exemplo")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("AUTH_CLIENT_ID")]),e._v(" "),t("td",[e._v("o Client ID do app apimanagement-devportal-web configurado no tenant b2c. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.app.Devportalweb.clientId")])]),e._v(" "),t("td",[e._v("11111111-1111-1111-1111-111111111111")])]),e._v(" "),t("tr",[t("td",[e._v("AUTH_CLIENT_SECRET")]),e._v(" "),t("td",[e._v("deixar vazio")]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("AUTH_SCOPES")]),e._v(" "),t("td",[e._v("url do tenant b2c para acesso aos escopos no formato https://{tenant b2c}.onmicrosoft.com/apione/access offline_access openid. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.Name")])]),e._v(" "),t("td",[e._v("https://b2c-exmaple.onmicrosoft.com/apione/access offline_access openid")])]),e._v(" "),t("tr",[t("td",[e._v("AUTH_TENANT_NAME")]),e._v(" "),t("td",[e._v("nome do tenant b2c. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.Name")])]),e._v(" "),t("td",[e._v("b2c-example")])]),e._v(" "),t("tr",[t("td",[e._v("IMAGES_DOMAIN")]),e._v(" "),t("td",[e._v("url de acesso ao bucket do cms no google storage")]),e._v(" "),t("td",[e._v("storage.googleapis.com/dhuo-cms")])]),e._v(" "),t("tr",[t("td",[e._v("NEXT_PUBLIC_APIMANAGEMENT_API_URL")]),e._v(" "),t("td",[e._v("url de acesso ao back-end da aplicação dhuo no formato {host}/it-management/")]),e._v(" "),t("td",[e._v("https://gateway-dhuo.br.engineering/it-management/")])]),e._v(" "),t("tr",[t("td",[e._v("NEXT_PUBLIC_AUTH_PASS_CHANGE")]),e._v(" "),t("td",[e._v("policy do ad b2c. Valor fixo.")]),e._v(" "),t("td",[e._v("B2C_1A_VV_PassChange")])]),e._v(" "),t("tr",[t("td",[e._v("NEXT_PUBLIC_AUTH_PROFILE_EDIT_PROVIDER")]),e._v(" "),t("td",[e._v("policy do ad b2c. Valor fixo.")]),e._v(" "),t("td",[e._v("B2C_1A_VV_ProfileEdit-Native")])]),e._v(" "),t("tr",[t("td",[e._v("NEXT_PUBLIC_AUTH_SU_PROVIDER")]),e._v(" "),t("td",[e._v("policy do ad b2c. Valor fixo.")]),e._v(" "),t("td",[e._v("B2C_1A_VV_EXT_SU")])]),e._v(" "),t("tr",[t("td",[e._v("NEXT_PUBLIC_AUTH_SUSI_PROVIDER")]),e._v(" "),t("td",[e._v("policy do ad b2c. Valor fixo.")]),e._v(" "),t("td",[e._v("B2C_1A_VV_EXT_SUSI")])]),e._v(" "),t("tr",[t("td",[e._v("NEXT_PUBLIC_ENVIRONMENT")]),e._v(" "),t("td",[e._v("valor fixo")]),e._v(" "),t("td",[e._v("SIT")])]),e._v(" "),t("tr",[t("td",[e._v("NEXT_PUBLIC_PORTAL_NAME")]),e._v(" "),t("td",[e._v("nome do developer portal a ser criado no dhuo")]),e._v(" "),t("td",[e._v("marketplace")])]),e._v(" "),t("tr",[t("td",[e._v("NEXT_PUBLIC_STRAPI_API_URL")]),e._v(" "),t("td",[e._v("url de acesso ao cms.")]),e._v(" "),t("td",[e._v("https://strapi-dhuo.com.br/")])]),e._v(" "),t("tr",[t("td",[e._v("NEXTAUTH_URL")]),e._v(" "),t("td",[e._v("url do developer portal")]),e._v(" "),t("td",[e._v("https://devportal-dhuo.br.engineering")])])])]),e._v(" "),t("p",[t("strong",[e._v("viaapi-web")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("variável")]),e._v(" "),t("th",[e._v("descrição")]),e._v(" "),t("th",[e._v("exemplo")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("API_URL")]),e._v(" "),t("td",[e._v("url de acesso ao back-end da aplicação dhuo no formato {host}/it-management.")]),e._v(" "),t("td",[e._v("https://gateway-dhuo.com.br/it-management")])]),e._v(" "),t("tr",[t("td",[e._v("AUTHORITY")]),e._v(" "),t("td",[e._v("url da policy de login do ad b2c no formato https://{tenant b2c}.b2clogin.com/{tenant b2c}.onmicrosoft.com/B2C_1A_VV_SUSI (fixo). Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.Name")])]),e._v(" "),t("td",[e._v("https://b2c-example.b2clogin.com/b2c-example.onmicrosoft.com/B2C_1A_VV_SUSI")])]),e._v(" "),t("tr",[t("td",[e._v("CLIENT_ID")]),e._v(" "),t("td",[e._v("o Client ID do app viaapi-web configurado no tenant b2c. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.app.Viaapiweb.clientId")])]),e._v(" "),t("td",[e._v("11111111-1111-1111-1111-111111111111")])]),e._v(" "),t("tr",[t("td",[e._v("DEFAULT_LANGUAGE")]),e._v(" "),t("td",[e._v("idioma padrão do portal admin. Valores possíveis pt-BR, en-US")]),e._v(" "),t("td",[e._v("pt-BR")])]),e._v(" "),t("tr",[t("td",[e._v("KNOWN_AUTHORITIES")]),e._v(" "),t("td",[e._v("domínio do ad b2c no formato {tenant b2c}.b2clogin.com. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.Name")])]),e._v(" "),t("td",[e._v("b2c-example.b2clogin.com")])]),e._v(" "),t("tr",[t("td",[e._v("POSTLOGOUT_REDIRECTURI")]),e._v(" "),t("td",[e._v("url de redirecionamento após logout do portal.")]),e._v(" "),t("td",[e._v("/")])]),e._v(" "),t("tr",[t("td",[e._v("SCOPES")]),e._v(" "),t("td",[e._v("url para acesso aos escopos da aplicação no formato https://{tenant b2c}.onmicrosoft.com/apione/access. Vide propriedade "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.Name")])]),e._v(" "),t("td",[e._v("https://kenissonb2c.onmicrosoft.com/apione/access")])])])]),e._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[e._v("Criar configmap do tipo Opaque com nome do módulo a partir do arquivo .env. Exemplo:")])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl create configmap generic "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("módulo dhuo"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" --from-env-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(".env -n "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("namespace"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[e._v("Configurar arquivos template de objetos kubernetes (deployment.yaml, service.yaml, hpa.yaml) a partir dos modelos presentes no repositório de templates de configuração do módulo em questão no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/k8s",target:"_blank",rel:"noopener noreferrer"}},[e._v("/k8s"),t("OutboundLink")],1),e._v(". "),t("strong",[e._v("Observação:")]),e._v(" tais arquivos são modelos de referência e podem ser customizados com outras propriedades além das existentes conforme necessidade.")])]),e._v(" "),t("li",[t("p",[e._v("Realizar deploy dos objetos kubernetes no cluster a partir dos arquivos de configuração do passo anterior. Exemplo:")])])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl apply -f <diretório>\n")])])]),t("h3",{attrs:{id:"cms-dhuo-strapi"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cms-dhuo-strapi"}},[e._v("#")]),e._v(" CMS (dhuo-strapi)")]),e._v(" "),t("ol",[t("li",[e._v("Criar e configurar um arquivo "),t("strong",[e._v(".env")]),e._v(" a partir do modelo presente no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/config",target:"_blank",rel:"noopener noreferrer"}},[e._v("/config"),t("OutboundLink")],1),e._v(" do repositório de templates de configuração do módulo em questão. As variáveis configuráveis estão relacionadas abaixo:")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("variável")]),e._v(" "),t("th",[e._v("descrição")]),e._v(" "),t("th",[e._v("exemplo")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("DATABASE_NAME")]),e._v(" "),t("td",[e._v("database do cms no mongodb")]),e._v(" "),t("td",[e._v("strapi")])]),e._v(" "),t("tr",[t("td",[e._v("DATABASE_HOST")]),e._v(" "),t("td",[e._v("hosts de conexão ao mongodb. Caso haja mais de um, separar por vírgulas.")]),e._v(" "),t("td",[e._v("dhuo-mongo-1,dhuo-mongo-mongodb-2")])]),e._v(" "),t("tr",[t("td",[e._v("DATABASE_PASSWORD")]),e._v(" "),t("td",[e._v("senha do usuário de acesso ao mongodb")]),e._v(" "),t("td",[e._v("123")])]),e._v(" "),t("tr",[t("td",[e._v("DATABASE_PORT")]),e._v(" "),t("td",[e._v("porta da conexão com o mongodb")]),e._v(" "),t("td",[e._v("27017")])]),e._v(" "),t("tr",[t("td",[e._v("DATABASE_USERNAME")]),e._v(" "),t("td",[e._v("usuário de conexão ao mongodb")]),e._v(" "),t("td",[e._v("root")])]),e._v(" "),t("tr",[t("td",[e._v("STORAGE_ACCOUNT_NAME")]),e._v(" "),t("td",[e._v("nome do bucket do google storage a ser utilizado pelo cms")]),e._v(" "),t("td",[e._v("dhuo-cms")])]),e._v(" "),t("tr",[t("td",[e._v("STORAGE_BASE_URL")]),e._v(" "),t("td",[e._v("url de acesso ao bucket do cms no google storage")]),e._v(" "),t("td",[e._v("https://storage.googleapis.com/dhuo-cms")])])])]),e._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[e._v("Criar secret do tipo Opaque com nome do módulo a partir do arquivo .env. Exemplo:")])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl create secret generic dhuo-strapi --from-env-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(".env -n "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("namespace"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[e._v("Configurar arquivos template de objetos kubernetes (deployment.yaml, service.yaml, hpa.yaml) a partir dos modelos presentes no repositório de templates de configuração do módulo em questão no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/k8s",target:"_blank",rel:"noopener noreferrer"}},[e._v("/k8s"),t("OutboundLink")],1),e._v(". "),t("strong",[e._v("Observação:")]),e._v(" tais arquivos são modelos de referência e podem ser customizados com outras propriedades além das existentes conforme necessidade.")])]),e._v(" "),t("li",[t("p",[e._v("Realizar deploy dos objetos kubernetes no cluster a partir dos arquivos de configuração do passo anterior. Exemplo:")])])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply -f "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("diretório"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("h3",{attrs:{id:"kong-back-end-gateway"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kong-back-end-gateway"}},[e._v("#")]),e._v(" Kong (back-end gateway)")]),e._v(" "),t("p",[t("strong",[e._v("Gerar JWT")])]),e._v(" "),t("p",[e._v("É necessário gerar uma chave rsa no formato pem a partir do jwk gerado no AD B2C. Para isso:")]),e._v(" "),t("ol",[t("li",[e._v("Acessar a configuração de openid gerada pelo tenant b2c em https://{tenant b2c}.b2clogin.com/{tenant b2c}.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=B2C_1A_VV_SUSI")]),e._v(" "),t("li",[e._v("Acessar a url definida na propriedade "),t("strong",[e._v("jwks_uri")])]),e._v(" "),t("li",[e._v("Gerar um arquivo .pem a partir do jwt definido na propriedade "),t("strong",[e._v("keys")]),e._v(".")])]),e._v(" "),t("p",[e._v("Ferramentas para conversão jwk-pem:")]),e._v(" "),t("ul",[t("li",[e._v("https://github.com/lffranca/openid")]),e._v(" "),t("li",[e._v("https://www.npmjs.com/package/jwk-to-pem")])]),e._v(" "),t("p",[t("strong",[e._v("Gerar Basic Auth")])]),e._v(" "),t("p",[e._v("Essas propriedades são cadastradas no AD B2C. Vide propriedades "),t("a",{attrs:{href:"/Manual-de-Instala%C3%A7%C3%A3o-On-Premise-DHUO/AD-B2C-%2D-Provisionamento-Azure"}},[e._v("b2cTenant.PolicyKeys.RestApiUsername e b2cTenant.PolicyKeys.RestApiPassword")]),e._v(".")]),e._v(" "),t("p",[t("strong",[e._v("Deploy kong")])]),e._v(" "),t("p",[e._v("Para configuração dos serviços de back-end do dhuo,")]),e._v(" "),t("ol",[t("li",[e._v("Utilize a versão atual do módulo "),t("code",[e._v("apione-kong")])]),e._v(" "),t("li",[e._v("Configure os certificados e consumers do kong presentes no arquivo , conforme relação a abaixo:")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("propriedade")]),e._v(" "),t("th",[e._v("descrição")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("consumers > jwt_secrets > key")]),e._v(" "),t("td",[e._v("valor da propriedade "),t("strong",[e._v("kid")]),e._v(" obtida no passo Gerar JWT")])]),e._v(" "),t("tr",[t("td",[e._v("consumers > jwt_secrets > rsa_public_key")]),e._v(" "),t("td",[e._v("arquivo .pem gerado a partir do jwk no passo Gerar JWT")])]),e._v(" "),t("tr",[t("td",[e._v("consumers > basicauth_credentials > password")]),e._v(" "),t("td",[e._v("propriedade b2cTenant.PolicyKeys.RestApiPassword no passo Gerar Basic Auth")])]),e._v(" "),t("tr",[t("td",[e._v("consumers > basicauth_credentials > username")]),e._v(" "),t("td",[e._v("propriedade b2cTenant.PolicyKeys.RestApiUsername no passo Gerar Basic Auth")])])])]),e._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[e._v("Caso necessário, altere o valor do campo "),t("strong",[e._v("host")]),e._v(" de cada service no arquivo dhuo.yaml presente no diretório "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/kong",target:"_blank",rel:"noopener noreferrer"}},[e._v("/kong"),t("OutboundLink")],1),e._v(" para corresponder ao host de instalação de cada módulo.")])]),e._v(" "),t("li",[t("p",[e._v("Utilizando a ferramenta "),t("code",[e._v("decK")]),e._v(", realize a importação das configurações do arquivo dhuo.yaml para a instância kong onde os serviços do dhuo serão expostos.")])])]),e._v(" "),t("p",[e._v("Exemplo:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("deck "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sync")]),e._v(" --kong-addr "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("konghost"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(":8001 --state dhuo.yaml \n")])])]),t("h3",{attrs:{id:"setup-strapi"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup-strapi"}},[e._v("#")]),e._v(" Setup strapi")]),e._v(" "),t("p",[e._v("Após deploy do módulo "),t("strong",[e._v("dhuo-strapi")]),e._v(",")]),e._v(" "),t("ol",[t("li",[e._v("Realize o primeiro acesso à intereface do strapi em {url-strapi}/admin")]),e._v(" "),t("li",[e._v("Cadastre o usuário administrador")]),e._v(" "),t("li",[e._v("Configure as permissões de acesso à api do cms acessando: Settings > USERS & PERMISSIONS PLUGIN > Roles")])]),e._v(" "),t("video",{attrs:{width:"800",height:"600",controls:""}},[t("source",{attrs:{src:"https://user-images.githubusercontent.com/191412/138390972-c558b850-b8d3-4acb-b9f3-058649826429.mp4",type:"video/mp4"}}),e._v("  \nYour browser does not support the video tag.\n")]),e._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[e._v("Editar a role "),t("strong",[e._v("Public")])]),e._v(" "),t("li",[e._v("Ativar as permissões conforme tabelas abaixo:")]),e._v(" "),t("li",[e._v("Após selecionar as permissões, clicar no botão salvar, no topo da página")])]),e._v(" "),t("p",[t("strong",[e._v("APPLICATION")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Categoria")]),e._v(" "),t("th",[e._v("Permissões")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("FONT")]),e._v(" "),t("td",[e._v("count, find, findone")])]),e._v(" "),t("tr",[t("td",[e._v("PORTAL")]),e._v(" "),t("td",[e._v("count, find, findone")])]),e._v(" "),t("tr",[t("td",[e._v("PORTAL-CATALOG")]),e._v(" "),t("td",[e._v("count, find, findone")])]),e._v(" "),t("tr",[t("td",[e._v("PORTAL-HOME")]),e._v(" "),t("td",[e._v("count, find, findone")])]),e._v(" "),t("tr",[t("td",[e._v("PORTAL-MENU")]),e._v(" "),t("td",[e._v("count, find, findone")])]),e._v(" "),t("tr",[t("td",[e._v("PORTAL-PAGE")]),e._v(" "),t("td",[e._v("count, find, findone")])]),e._v(" "),t("tr",[t("td",[e._v("PORTAL-THEME")]),e._v(" "),t("td",[e._v("count, find, findone")])]),e._v(" "),t("tr",[t("td",[e._v("STYLE")]),e._v(" "),t("td",[e._v("count, find, findone")])])])]),e._v(" "),t("p",[t("strong",[e._v("CONTENT-MANAGER")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Categoria")]),e._v(" "),t("th",[e._v("Permissões")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("COLLECTION-TYPES")]),e._v(" "),t("td",[e._v("findone, find, previewmanyrelations")])]),e._v(" "),t("tr",[t("td",[e._v("COMPONENTS")]),e._v(" "),t("td",[e._v("findcomponentconfiguration, findcomponents")])]),e._v(" "),t("tr",[t("td",[e._v("CONTENT-TYPES")]),e._v(" "),t("td",[e._v("findcontenttypeconfiguration, findcontenttypes")])]),e._v(" "),t("tr",[t("td",[e._v("RELATIONS")]),e._v(" "),t("td",[e._v("find")])]),e._v(" "),t("tr",[t("td",[e._v("SINGLE-TYPES")]),e._v(" "),t("td",[e._v("find")])]),e._v(" "),t("tr",[t("td",[e._v("UID")]),e._v(" "),t("td",[e._v("checkuidavailability")])])])]),e._v(" "),t("p",[t("strong",[e._v("CONTENT-TYPE-BUILDER")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Categoria")]),e._v(" "),t("th",[e._v("Permissões")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("BUILDER")]),e._v(" "),t("td",[e._v("getreservednames")])]),e._v(" "),t("tr",[t("td",[e._v("COMPONENTS")]),e._v(" "),t("td",[e._v("getcomponent, getcomponents")])]),e._v(" "),t("tr",[t("td",[e._v("CONNECTIONS")]),e._v(" "),t("td",[e._v("getconnections")])]),e._v(" "),t("tr",[t("td",[e._v("CONTENTTYPES")]),e._v(" "),t("td",[e._v("getcontenttype, getcontenttypes")])])])]),e._v(" "),t("p",[t("strong",[e._v("UPLOAD")])]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Categoria")]),e._v(" "),t("th",[e._v("Permissões")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("UPLOAD")]),e._v(" "),t("td",[e._v("count, find, findone, search")])])])]),e._v(" "),t("h3",{attrs:{id:"setup-mongodb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup-mongodb"}},[e._v("#")]),e._v(" Setup mongodb")]),e._v(" "),t("p",[e._v("Após deploy dos módulos de back-end do dhuo")]),e._v(" "),t("ol",[t("li",[e._v("Acessar a instância do mongodb")]),e._v(" "),t("li",[e._v("Realizar a carga inicial de dados na collection "),t("strong",[e._v("environment")]),e._v(" da database dhuo, com os dados do arquivo "),t("strong",[e._v("environment.json")]),e._v(" presente em "),t("a",{attrs:{href:"https://gitlab.engdb.com.br/apione/dhuoapi-install/-/tree/master/mongodb",target:"_blank",rel:"noopener noreferrer"}},[e._v("/mongodb"),t("OutboundLink")],1),e._v(".")])])])}),[],!1,null,null,null);a.default=r.exports}}]);